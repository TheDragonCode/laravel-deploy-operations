import{_ as a,c as n,b as s,o as t}from"./app-DbZK4p7a.js";const i={};function o(r,e){return t(),n("div",null,e[0]||(e[0]=[s(`<h1 id="upgrading-to-3-x-from-2-x" tabindex="-1"><a class="header-anchor" href="#upgrading-to-3-x-from-2-x"><span>Upgrading To 3.x from 2.x</span></a></h1><h3 id="high-impact-changes" tabindex="-1"><a class="header-anchor" href="#high-impact-changes"><span>High Impact Changes</span></a></h3><ul><li><a href="#configuration">Change the location of the configuration file</a></li><li><a href="#anonymous-classes">Replacing named classes with anonymous ones</a></li><li><a href="#parent-namespace">Changing the namespace of the parent class</a></li><li><a href="#changed-properties">Changing variable names from <code>snake_case</code> to <code>camelCase</code> and added typing</a></li><li><a href="#added-recursive-search-for-actions-in-a-folder">Added recursive search for actions in a folder</a></li><li><a href="#php-802-required">PHP 7.3 and 7.4 was dropped</a></li><li>Laravel 6.0 was dropped</li><li>Dragon Code: Contracts (<code>dragon-code/contracts</code>) was dropped</li></ul><h3 id="medium-impact-changes" tabindex="-1"><a class="header-anchor" href="#medium-impact-changes"><span>Medium Impact Changes</span></a></h3><ul><li><a href="#changed-action-repository">Changing the name of an action column in the database</a></li><li><a href="#actions-location">Action storage directory changed</a></li></ul><h2 id="the-easiest-way-to-upgrade" tabindex="-1"><a class="header-anchor" href="#the-easiest-way-to-upgrade"><span>The easiest way to upgrade</span></a></h2><blockquote><p>Note If you used inheritance of actions from other actions, then you will need to process these files manually.</p></blockquote><p>For your convenience, we have created an upgrade console command:</p><div class="language-bash line-numbers-mode" data-highlighter="prismjs" data-ext="sh" data-title="sh"><pre><code><span class="line"><span class="token function">composer</span> require dragon-code/laravel-migration-actions:^3.0</span>
<span class="line">php artisan migrate:actions:upgrade</span>
<span class="line">php artisan migrate</span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>It will do the following:</p><ul><li>Change the namespace of the abstract class</li><li>Add a strict type declaration</li><li>Replace the <code>up</code> method with <code>__invoke</code> if the class does not have a <code>down</code> method</li><li>Replace named classes with anonymous ones</li><li>Create a configuration file according to the data saved in your project</li><li>Changes properties from <code>snake_case</code> to <code>camelCase</code></li></ul><h2 id="updating-dependencies" tabindex="-1"><a class="header-anchor" href="#updating-dependencies"><span>Updating Dependencies</span></a></h2><h3 id="php-8-0-2-required" tabindex="-1"><a class="header-anchor" href="#php-8-0-2-required"><span>PHP 8.0.2 Required</span></a></h3><p>Deploy Actions for Laravel now requires PHP 8.0.2 or greater.</p><h3 id="composer-dependencies" tabindex="-1"><a class="header-anchor" href="#composer-dependencies"><span>Composer Dependencies</span></a></h3><p>You should update the following dependency in your application&#39;s <code>composer.json</code> file:</p><ul><li><code>dragon-code/laravel-migration-actions</code> to <code>^3.0</code></li></ul><h2 id="configuration" tabindex="-1"><a class="header-anchor" href="#configuration"><span>Configuration</span></a></h2><p>Publish the config file and migrate the settings from the <code>config/database.php</code> file to <code>config/actions.php</code>.</p><div class="language-bash line-numbers-mode" data-highlighter="prismjs" data-ext="sh" data-title="sh"><pre><code><span class="line">php artisan vendor:publish <span class="token parameter variable">--provider</span><span class="token operator">=</span><span class="token string">&quot;DragonCode\\LaravelActions\\ServiceProvider&quot;</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><h2 id="actions-location" tabindex="-1"><a class="header-anchor" href="#actions-location"><span>Actions Location</span></a></h2><p>Move the action files to the <code>actions</code> folder in the project root, or update the <code>actions.path</code> option in the configuration file.</p><h2 id="parent-namespace" tabindex="-1"><a class="header-anchor" href="#parent-namespace"><span>Parent Namespace</span></a></h2><p>Replace <code>DragonCode\\LaravelActions\\Support\\Actionable</code> with <code>DragonCode\\LaravelActions\\Action</code>.</p><h2 id="anonymous-classes" tabindex="-1"><a class="header-anchor" href="#anonymous-classes"><span>Anonymous Classes</span></a></h2><p>Replace named calls to your application&#39;s classes with anonymous ones.</p><p>For example:</p><div class="language-php line-numbers-mode" data-highlighter="prismjs" data-ext="php" data-title="php"><pre><code><span class="line"><span class="token comment">// before</span></span>
<span class="line"><span class="token keyword">use</span> <span class="token package">DragonCode<span class="token punctuation">\\</span>LaravelActions<span class="token punctuation">\\</span>Support<span class="token punctuation">\\</span>Actionable</span><span class="token punctuation">;</span></span>
<span class="line"></span>
<span class="line"><span class="token keyword">class</span> <span class="token class-name-definition class-name">Some</span> <span class="token keyword">extends</span> <span class="token class-name">Actionable</span> <span class="token punctuation">{</span><span class="token punctuation">}</span></span>
<span class="line"></span>
<span class="line"><span class="token comment">// after</span></span>
<span class="line"><span class="token keyword">use</span> <span class="token package">DragonCode<span class="token punctuation">\\</span>LaravelActions<span class="token punctuation">\\</span>Action</span><span class="token punctuation">;</span></span>
<span class="line"></span>
<span class="line"><span class="token keyword">return</span> <span class="token keyword">new</span> <span class="token keyword">class</span> <span class="token class-name-definition class-name">extends</span> <span class="token class-name">Action</span> <span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">;</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h2 id="invokable-method" tabindex="-1"><a class="header-anchor" href="#invokable-method"><span>Invokable Method</span></a></h2><p>If your class does not contain a <code>down</code> method, then you can replace the <code>up</code> method with <code>__invoke</code>.</p><h2 id="changed-action-repository" tabindex="-1"><a class="header-anchor" href="#changed-action-repository"><span>Changed Action Repository</span></a></h2><p>Just call the <code>php artisan migrate</code> command to make changes to the action repository table.</p><h2 id="changed-properties" tabindex="-1"><a class="header-anchor" href="#changed-properties"><span>Changed Properties</span></a></h2><p>Make sure all overridden properties are typed:</p><table><thead><tr><th>Old Name</th><th>New Name</th></tr></thead><tbody><tr><td>protected $once</td><td>protected bool $once</td></tr><tr><td>protected $transactions</td><td>protected bool $transactions</td></tr><tr><td>protected $transaction_attempts</td><td>protected int $transactionAttempts</td></tr><tr><td>protected $environment</td><td>protected string|array|null $environment</td></tr><tr><td>protected $except_environment</td><td>protected string|array|null $exceptEnvironment</td></tr><tr><td>protected $before</td><td>protected bool $before</td></tr></tbody></table><h2 id="added-recursive-search-for-actions-in-a-folder" tabindex="-1"><a class="header-anchor" href="#added-recursive-search-for-actions-in-a-folder"><span>Added recursive search for actions in a folder</span></a></h2><h3 id="before" tabindex="-1"><a class="header-anchor" href="#before"><span>Before:</span></a></h3><div class="language-bash line-numbers-mode" data-highlighter="prismjs" data-ext="sh" data-title="sh"><pre><code><span class="line">2022_10_13_013321_test1</span>
<span class="line">2022_10_13_013326_test2</span>
<span class="line">bar/2022_10_13_013323_test3 <span class="token comment"># will not be called</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="after" tabindex="-1"><a class="header-anchor" href="#after"><span>After:</span></a></h3><div class="language-bash line-numbers-mode" data-highlighter="prismjs" data-ext="sh" data-title="sh"><pre><code><span class="line">2022_10_13_013321_test1</span>
<span class="line">2022_10_13_013326_test2</span>
<span class="line">bar/2022_10_13_013323_test3 <span class="token comment"># will be called</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div>`,40)]))}const l=a(i,[["render",o],["__file","3.x.html.vue"]]),d=JSON.parse('{"path":"/upgrade-guide/3.x.html","title":"Upgrading To 3.x from 2.x","lang":"en-US","frontmatter":{"description":"Upgrading To 3.x from 2.x High Impact Changes Change the location of the configuration file Replacing named classes with anonymous ones Changing the namespace of the parent clas...","head":[["meta",{"property":"og:url","content":"https://deploy-operations.dragon-code.pro/upgrade-guide/3.x.html"}],["meta",{"property":"og:site_name","content":"Laravel Deploy Operations"}],["meta",{"property":"og:title","content":"Upgrading To 3.x from 2.x"}],["meta",{"property":"og:description","content":"Upgrading To 3.x from 2.x High Impact Changes Change the location of the configuration file Replacing named classes with anonymous ones Changing the namespace of the parent clas..."}],["meta",{"property":"og:type","content":"article"}],["meta",{"property":"og:locale","content":"en-US"}],["meta",{"property":"og:updated_time","content":"2024-05-22T20:24:51.000Z"}],["meta",{"property":"article:modified_time","content":"2024-05-22T20:24:51.000Z"}],["script",{"type":"application/ld+json"},"{\\"@context\\":\\"https://schema.org\\",\\"@type\\":\\"Article\\",\\"headline\\":\\"Upgrading To 3.x from 2.x\\",\\"image\\":[\\"\\"],\\"dateModified\\":\\"2024-05-22T20:24:51.000Z\\",\\"author\\":[]}"]]},"headers":[{"level":3,"title":"High Impact Changes","slug":"high-impact-changes","link":"#high-impact-changes","children":[]},{"level":3,"title":"Medium Impact Changes","slug":"medium-impact-changes","link":"#medium-impact-changes","children":[]},{"level":2,"title":"The easiest way to upgrade","slug":"the-easiest-way-to-upgrade","link":"#the-easiest-way-to-upgrade","children":[]},{"level":2,"title":"Updating Dependencies","slug":"updating-dependencies","link":"#updating-dependencies","children":[{"level":3,"title":"PHP 8.0.2 Required","slug":"php-8-0-2-required","link":"#php-8-0-2-required","children":[]},{"level":3,"title":"Composer Dependencies","slug":"composer-dependencies","link":"#composer-dependencies","children":[]}]},{"level":2,"title":"Configuration","slug":"configuration","link":"#configuration","children":[]},{"level":2,"title":"Actions Location","slug":"actions-location","link":"#actions-location","children":[]},{"level":2,"title":"Parent Namespace","slug":"parent-namespace","link":"#parent-namespace","children":[]},{"level":2,"title":"Anonymous Classes","slug":"anonymous-classes","link":"#anonymous-classes","children":[]},{"level":2,"title":"Invokable Method","slug":"invokable-method","link":"#invokable-method","children":[]},{"level":2,"title":"Changed Action Repository","slug":"changed-action-repository","link":"#changed-action-repository","children":[]},{"level":2,"title":"Changed Properties","slug":"changed-properties","link":"#changed-properties","children":[]},{"level":2,"title":"Added recursive search for actions in a folder","slug":"added-recursive-search-for-actions-in-a-folder","link":"#added-recursive-search-for-actions-in-a-folder","children":[{"level":3,"title":"Before:","slug":"before","link":"#before","children":[]},{"level":3,"title":"After:","slug":"after","link":"#after","children":[]}]}],"git":{"updatedTime":1716409491000},"autoDesc":true,"filePathRelative":"upgrade-guide/3.x.md"}');export{l as comp,d as data};
