import{_ as t,c as o,b as n,a as i,f as a,d as c,e as d,r as p,o as l}from"./app-DbZK4p7a.js";const r={};function h(m,e){const s=p("RouteLink");return l(),o("div",null,[e[3]||(e[3]=n(`<h1 id="upgrading-to-6-x-from-5-x" tabindex="-1"><a class="header-anchor" href="#upgrading-to-6-x-from-5-x"><span>Upgrading To 6.x from 5.x</span></a></h1><h2 id="high-impact-changes" tabindex="-1"><a class="header-anchor" href="#high-impact-changes"><span>High-Impact Changes</span></a></h2><ul><li><a href="#updating-dependencies">Updating Dependencies</a></li><li><a href="#changed-the-namespace">Changed the namespace</a></li><li><a href="#changed-the-name-of-the-main-class">Changed the name of the main class</a></li><li><a href="#changed-names-of-console-commands">Changed names of console commands</a></li><li><a href="#changed-event-names">Changed event names</a></li><li><a href="#configuration-file-name-changed">Configuration file name changed</a></li></ul><h2 id="minor-impact-changes" tabindex="-1"><a class="header-anchor" href="#minor-impact-changes"><span>Minor-Impact Changes</span></a></h2><ul><li><a href="#changed-directory-location">Changed directory location</a></li><li><a href="#database-transactions">Database transactions</a></li><li><a href="#removed-async-property">Removed <code>$async</code> property</a></li><li><a href="#removed-operationsstub-command">Removed <code>operations:stub</code> command</a></li><li><a href="#changed-property-typing-for-events">Changed property typing for events</a></li></ul><h2 id="low-impact-changes" tabindex="-1"><a class="header-anchor" href="#low-impact-changes"><span>Low-Impact Changes</span></a></h2><ul><li><a href="#stub-name-changed">Stub name changed</a></li></ul><h2 id="the-easiest-way-to-upgrade" tabindex="-1"><a class="header-anchor" href="#the-easiest-way-to-upgrade"><span>The easiest way to upgrade</span></a></h2><blockquote><p>Note If you used inheritance of actions from other actions, then you will need to process these files manually.</p></blockquote><p>For your convenience, we have created an <code>upgrade</code> console command:</p><div class="language-bash line-numbers-mode" data-highlighter="prismjs" data-ext="sh" data-title="sh"><pre><code><span class="line"><span class="token function">composer</span> remove dragon-code/laravel-actions</span>
<span class="line"><span class="token function">composer</span> require dragon-code/laravel-deploy-operations:^6.0</span>
<span class="line"></span>
<span class="line">php artisan operations:upgrade</span>
<span class="line">php artisan migrate</span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>It will do the following:</p><ul><li>Changing the old namespace of “actions” to a new one</li><li>Moves files to a new location</li><li>Updates the configuration file</li><li>Rename the stub file (if published)</li></ul><p>Please note that the script allows you to automate most of the actions, but may not complete them completely. Therefore, you will need to manually check the result of the upgrade by checking this guide.</p><h2 id="updating-dependencies" tabindex="-1"><a class="header-anchor" href="#updating-dependencies"><span>Updating Dependencies</span></a></h2><p>You should change the package name in the <code>composer.json</code> file from <code>dragon-code/laravel-actions</code> to <code>dragon-code/laravel-deploy-operations</code>, and also change its version to <code>^6.0</code>:</p><div class="language-json line-numbers-mode" data-highlighter="prismjs" data-ext="json" data-title="json"><pre><code><span class="line"><span class="token punctuation">{</span></span>
<span class="line">    <span class="token property">&quot;require&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span></span>
<span class="line">        <span class="token comment">// ...</span></span>
<span class="line">        <span class="token property">&quot;dragon-code/laravel-deploy-operations&quot;</span><span class="token operator">:</span> <span class="token string">&quot;^6.0&quot;</span></span>
<span class="line">    <span class="token punctuation">}</span></span>
<span class="line"><span class="token punctuation">}</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>Then you need to update the dependencies:</p><div class="language-bash line-numbers-mode" data-highlighter="prismjs" data-ext="sh" data-title="sh"><pre><code><span class="line"><span class="token function">composer</span> update</span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><h2 id="changed-the-namespace" tabindex="-1"><a class="header-anchor" href="#changed-the-namespace"><span>Changed the namespace</span></a></h2><p>The namespace has been changed from <code>DragonCode\\LaravelActions</code> to <code>DragonCode\\LaravelDeployOperations</code>.</p>`,21)),i("p",null,[e[1]||(e[1]=a("You need to replace it in all actions of your application, as well as when using ")),c(s,{to:"/helpers/events.html"},{default:d(()=>e[0]||(e[0]=[a("events")])),_:1}),e[2]||(e[2]=a("."))]),e[4]||(e[4]=n(`<h2 id="changed-the-name-of-the-main-class" tabindex="-1"><a class="header-anchor" href="#changed-the-name-of-the-main-class"><span>Changed the name of the main class</span></a></h2><p>You should replace <code>DragonCode\\LaravelActions\\Action</code> namespace with <code>DragonCode\\LaravelDeployOperations\\Operation</code>.</p><h2 id="changed-names-of-console-commands" tabindex="-1"><a class="header-anchor" href="#changed-names-of-console-commands"><span>Changed names of console commands</span></a></h2><table><thead><tr><th>New Name</th><th>Old Name</th></tr></thead><tbody><tr><td><code>make:operation</code></td><td><code>make:action</code></td></tr><tr><td><code>operations</code></td><td><code>actions</code></td></tr><tr><td><code>operations:fresh</code></td><td><code>actions:fresh</code></td></tr><tr><td><code>operations:install</code></td><td><code>actions:install</code></td></tr><tr><td><code>operations:refresh</code></td><td><code>actions:refresh</code></td></tr><tr><td><code>operations:reset</code></td><td><code>actions:reset</code></td></tr><tr><td><code>operations:rollback</code></td><td><code>actions:rollback</code></td></tr><tr><td><code>operations:status</code></td><td><code>actions:status</code></td></tr><tr><td><code>operations:stub</code></td><td><code>actions:stub</code></td></tr><tr><td><code>operations:upgrade</code></td><td><code>actions:upgrade</code></td></tr></tbody></table><h2 id="changed-event-names" tabindex="-1"><a class="header-anchor" href="#changed-event-names"><span>Changed event names</span></a></h2><table><thead><tr><th>New Name</th><th>Old Name</th></tr></thead><tbody><tr><td><code>DeployOperationStarted</code></td><td><code>ActionStarted</code></td></tr><tr><td><code>DeployOperationEnded</code></td><td><code>ActionEnded</code></td></tr><tr><td><code>DeployOperationFailed</code></td><td><code>ActionFailed</code></td></tr><tr><td><code>NoPendingDeployOperations</code></td><td><code>NoPendingActions</code></td></tr></tbody></table><p>Don&#39;t forget to also change the namespace from <code>DragonCode\\LaravelActions\\Events</code> to <code>DragonCode\\LaravelDeployOperations\\Events</code>.</p><h2 id="changed-property-typing-for-events" tabindex="-1"><a class="header-anchor" href="#changed-property-typing-for-events"><span>Changed property typing for events</span></a></h2><p>The type of the <code>method</code> property for events has been changed.</p><p>Before:</p><div class="language-php line-numbers-mode" data-highlighter="prismjs" data-ext="php" data-title="php"><pre><code><span class="line"><span class="token keyword">use</span> <span class="token package">DragonCode<span class="token punctuation">\\</span>LaravelActions<span class="token punctuation">\\</span>Events<span class="token punctuation">\\</span>ActionEnded</span><span class="token punctuation">;</span></span>
<span class="line"><span class="token keyword">use</span> <span class="token package">DragonCode<span class="token punctuation">\\</span>LaravelDeployOperations<span class="token punctuation">\\</span>Enums<span class="token punctuation">\\</span>MethodEnum</span><span class="token punctuation">;</span></span>
<span class="line"></span>
<span class="line"><span class="token doc-comment comment">/** <span class="token keyword">@var</span> <span class="token class-name">ActionEnded</span> */</span></span>
<span class="line"><span class="token variable">$event</span><span class="token operator">-&gt;</span><span class="token property">method</span><span class="token punctuation">;</span> <span class="token comment">// is string</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>After:</p><div class="language-php line-numbers-mode" data-highlighter="prismjs" data-ext="php" data-title="php"><pre><code><span class="line"><span class="token keyword">use</span> <span class="token package">DragonCode<span class="token punctuation">\\</span>LaravelDeployOperations<span class="token punctuation">\\</span>Enums<span class="token punctuation">\\</span>MethodEnum</span><span class="token punctuation">;</span></span>
<span class="line"><span class="token keyword">use</span> <span class="token package">DragonCode<span class="token punctuation">\\</span>LaravelDeployOperations<span class="token punctuation">\\</span>Events<span class="token punctuation">\\</span>DeployOperationEnded</span><span class="token punctuation">;</span></span>
<span class="line"></span>
<span class="line"><span class="token doc-comment comment">/** <span class="token keyword">@var</span> <span class="token class-name">DeployOperationEnded</span> */</span></span>
<span class="line"><span class="token variable">$event</span><span class="token operator">-&gt;</span><span class="token property">method</span><span class="token punctuation">;</span> <span class="token comment">// is MethodEnum</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h2 id="configuration-file-name-changed" tabindex="-1"><a class="header-anchor" href="#configuration-file-name-changed"><span>Configuration file name changed</span></a></h2><p>We recommend that you delete the old configuration file <code>config/actions.php</code> and publish a new one. This way you will see the changes made to it.</p><div class="language-bash line-numbers-mode" data-highlighter="prismjs" data-ext="sh" data-title="sh"><pre><code><span class="line">php artisan vendor:publish <span class="token parameter variable">--provider</span><span class="token operator">=</span><span class="token string">&quot;DragonCode\\LaravelDeployOperations\\ServiceProvider&quot;</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><h2 id="changed-names-of-constants" tabindex="-1"><a class="header-anchor" href="#changed-names-of-constants"><span>Changed names of constants</span></a></h2><p>If you use package constant references, you must also rename them.</p><p>The old name was in <code>UPPER_CASE</code>, the new one was in <code>PascalCase</code>.</p><p>For example:</p><div class="language-php line-numbers-mode" data-highlighter="prismjs" data-ext="php" data-title="php"><pre><code><span class="line"><span class="token comment">// Old</span></span>
<span class="line"><span class="token keyword">class</span> <span class="token class-name-definition class-name">Names</span></span>
<span class="line"><span class="token punctuation">{</span></span>
<span class="line">    <span class="token keyword">public</span> <span class="token keyword">const</span> <span class="token constant">ACTIONS</span> <span class="token operator">=</span> <span class="token string single-quoted-string">&#39;actions&#39;</span><span class="token punctuation">;</span></span>
<span class="line">    <span class="token keyword">public</span> <span class="token keyword">const</span> <span class="token constant">FRESH</span> <span class="token operator">=</span> <span class="token string single-quoted-string">&#39;actions:fresh&#39;</span><span class="token punctuation">;</span></span>
<span class="line">    <span class="token comment">// ...</span></span>
<span class="line"><span class="token punctuation">}</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><div class="language-php line-numbers-mode" data-highlighter="prismjs" data-ext="php" data-title="php"><pre><code><span class="line"><span class="token comment">// New</span></span>
<span class="line"><span class="token keyword">class</span> <span class="token class-name-definition class-name">Names</span></span>
<span class="line"><span class="token punctuation">{</span></span>
<span class="line">    <span class="token keyword">public</span> <span class="token keyword">const</span> <span class="token constant">Operations</span> <span class="token operator">=</span> <span class="token string single-quoted-string">&#39;operations&#39;</span><span class="token punctuation">;</span></span>
<span class="line">    <span class="token keyword">public</span> <span class="token keyword">const</span> <span class="token constant">Fresh</span> <span class="token operator">=</span> <span class="token string single-quoted-string">&#39;operations:fresh&#39;</span><span class="token punctuation">;</span></span>
<span class="line">    <span class="token comment">// ...</span></span>
<span class="line"><span class="token punctuation">}</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h2 id="changed-directory-location" tabindex="-1"><a class="header-anchor" href="#changed-directory-location"><span>Changed directory location</span></a></h2><p>File storage directory changed to <code>operations</code> from <code>actions</code>.</p><h2 id="database-transactions" tabindex="-1"><a class="header-anchor" href="#database-transactions"><span>Database transactions</span></a></h2><p>The following properties have been removed:</p><ul><li><code>$transactions</code></li><li><code>$transactionAttempts</code></li></ul><p>Instead, you can use the <code>hasTransactions</code> and <code>transactionAttempts</code> methods.</p><p>The <code>enabledTransactions</code> method has been renamed to <code>hasTransactions</code>.</p><h2 id="removed-async-property" tabindex="-1"><a class="header-anchor" href="#removed-async-property"><span>Removed <code>$async</code> property</span></a></h2><p>The <code>$async</code> property has been removed from the base class. You can use the previously available <code>isAsync</code> method instead.</p><h2 id="stub-name-changed" tabindex="-1"><a class="header-anchor" href="#stub-name-changed"><span>Stub name changed</span></a></h2><p>If you published a stub file, then you also need to rename it from <code>stubs/action.stub</code> to <code>stubs/deploy-operation.stub</code> and make changes to its structure.</p><h2 id="removed-operations-stub-command" tabindex="-1"><a class="header-anchor" href="#removed-operations-stub-command"><span>Removed <code>operations:stub</code> command</span></a></h2><p>The <code>php artisan operations:stub</code> console command has been removed. Use another command instead:</p><div class="language-bash line-numbers-mode" data-highlighter="prismjs" data-ext="sh" data-title="sh"><pre><code><span class="line">php artisan vendor:publish <span class="token parameter variable">--tag</span><span class="token operator">=</span>stubs <span class="token parameter variable">--provider</span><span class="token operator">=</span><span class="token string">&quot;DragonCode\\LaravelDeployOperations\\ServiceProvider&quot;</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div>`,36))])}const g=t(r,[["render",h],["__file","6.x.html.vue"]]),v=JSON.parse('{"path":"/upgrade-guide/6.x.html","title":"Upgrading To 6.x from 5.x","lang":"en-US","frontmatter":{"description":"Upgrading To 6.x from 5.x High-Impact Changes Updating Dependencies Changed the namespace Changed the name of the main class Changed names of console commands Changed event name...","head":[["meta",{"property":"og:url","content":"https://deploy-operations.dragon-code.pro/upgrade-guide/6.x.html"}],["meta",{"property":"og:site_name","content":"Laravel Deploy Operations"}],["meta",{"property":"og:title","content":"Upgrading To 6.x from 5.x"}],["meta",{"property":"og:description","content":"Upgrading To 6.x from 5.x High-Impact Changes Updating Dependencies Changed the namespace Changed the name of the main class Changed names of console commands Changed event name..."}],["meta",{"property":"og:type","content":"article"}],["meta",{"property":"og:locale","content":"en-US"}],["meta",{"property":"og:updated_time","content":"2024-05-22T20:34:47.000Z"}],["meta",{"property":"article:modified_time","content":"2024-05-22T20:34:47.000Z"}],["script",{"type":"application/ld+json"},"{\\"@context\\":\\"https://schema.org\\",\\"@type\\":\\"Article\\",\\"headline\\":\\"Upgrading To 6.x from 5.x\\",\\"image\\":[\\"\\"],\\"dateModified\\":\\"2024-05-22T20:34:47.000Z\\",\\"author\\":[]}"]]},"headers":[{"level":2,"title":"High-Impact Changes","slug":"high-impact-changes","link":"#high-impact-changes","children":[]},{"level":2,"title":"Minor-Impact Changes","slug":"minor-impact-changes","link":"#minor-impact-changes","children":[]},{"level":2,"title":"Low-Impact Changes","slug":"low-impact-changes","link":"#low-impact-changes","children":[]},{"level":2,"title":"The easiest way to upgrade","slug":"the-easiest-way-to-upgrade","link":"#the-easiest-way-to-upgrade","children":[]},{"level":2,"title":"Updating Dependencies","slug":"updating-dependencies","link":"#updating-dependencies","children":[]},{"level":2,"title":"Changed the namespace","slug":"changed-the-namespace","link":"#changed-the-namespace","children":[]},{"level":2,"title":"Changed the name of the main class","slug":"changed-the-name-of-the-main-class","link":"#changed-the-name-of-the-main-class","children":[]},{"level":2,"title":"Changed names of console commands","slug":"changed-names-of-console-commands","link":"#changed-names-of-console-commands","children":[]},{"level":2,"title":"Changed event names","slug":"changed-event-names","link":"#changed-event-names","children":[]},{"level":2,"title":"Changed property typing for events","slug":"changed-property-typing-for-events","link":"#changed-property-typing-for-events","children":[]},{"level":2,"title":"Configuration file name changed","slug":"configuration-file-name-changed","link":"#configuration-file-name-changed","children":[]},{"level":2,"title":"Changed names of constants","slug":"changed-names-of-constants","link":"#changed-names-of-constants","children":[]},{"level":2,"title":"Changed directory location","slug":"changed-directory-location","link":"#changed-directory-location","children":[]},{"level":2,"title":"Database transactions","slug":"database-transactions","link":"#database-transactions","children":[]},{"level":2,"title":"Removed $async property","slug":"removed-async-property","link":"#removed-async-property","children":[]},{"level":2,"title":"Stub name changed","slug":"stub-name-changed","link":"#stub-name-changed","children":[]},{"level":2,"title":"Removed operations:stub command","slug":"removed-operations-stub-command","link":"#removed-operations-stub-command","children":[]}],"git":{"updatedTime":1716410087000},"autoDesc":true,"filePathRelative":"upgrade-guide/6.x.md"}');export{g as comp,v as data};
